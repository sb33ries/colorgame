<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Guess the Color</title>
  <style>
    body {
      background-color: #121212;
      color: #f0f0f0;
      font-family: 'Segoe UI', sans-serif;
      padding: 2rem;
    }

    h1, h3 {
      color: #ffffff;
    }

    .container {
      max-width: 800px;
      margin: auto;
    }

    .row {
      display: flex;
      gap: 2rem;
      align-items: center;
      flex-wrap: wrap;
    }

    .color-box {
      width: 150px;
      height: 150px;
      border: 2px solid #888;
      border-radius: 8px;
      margin-top: 10px;
    }

    .hidden {
      visibility: hidden;
    }

    input[type="text"], input[type="color"] {
      padding: 0.4rem;
      border-radius: 5px;
      border: none;
      font-size: 1rem;
    }

    button {
      padding: 0.5rem 1rem;
      margin-top: 0.5rem;
      background-color: #1e88e5;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #1565c0;
    }

    #results {
      margin-top: 2rem;
      padding-top: 1rem;
      border-top: 1px solid #555;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Guess the Color</h1>

    <label for="seedInput">Enter a seed (optional):</label><br>
    <input type="text" id="seedInput" placeholder="Leave blank for random seed"><br>
    <button id="startBtn">Start</button>

    <p>Seed used: <span id="seedDisplay">None</span></p>

    <div class="row">
      <div>
        <h3>Reference Color</h3>
        <div id="referenceColor" class="color-box hidden"></div>
      </div>

      <div>
        <h3>Your Guess</h3>
        <input type="color" id="colorGuess"><br>
        <div id="guessColor" class="color-box"></div>
        <button id="submitGuess">Submit Guess</button>
      </div>
    </div>

    <div id="results"></div>
  </div>

  <script>
    let targetColor = { r: 0, g: 0, b: 0 };
    let seed = "";

    function mulberry32(a) {
      return function () {
        var t = a += 0x6D2B79F5;
        t = Math.imul(t ^ t >>> 15, t | 1);
        t ^= t + Math.imul(t ^ t >>> 7, t | 61);
        return ((t ^ t >>> 14) >>> 0) / 4294967296;
      }
    }

    function seededColor(seedStr) {
      let hash = 0;
      for (let i = 0; i < seedStr.length; i++) {
        hash = seedStr.charCodeAt(i) + ((hash << 5) - hash);
      }
      const rand = mulberry32(hash);
      return {
        r: Math.floor(rand() * 256),
        g: Math.floor(rand() * 256),
        b: Math.floor(rand() * 256),
      };
    }

    function showColor(box, color) {
      box.style.backgroundColor = `rgb(${color.r}, ${color.g}, ${color.b})`;
    }

    function hideElement(el) {
      el.classList.add('hidden');
    }

    function showElement(el) {
      el.classList.remove('hidden');
    }

    function hexToRGB(hex) {
      const r = parseInt(hex.slice(1, 3), 16);
      const g = parseInt(hex.slice(3, 5), 16);
      const b = parseInt(hex.slice(5, 7), 16);
      return { r, g, b };
    }

    function calculateAccuracy(actual, guess) {
      const diff = Math.sqrt(
        Math.pow(actual.r - guess.r, 2) +
        Math.pow(actual.g - guess.g, 2) +
        Math.pow(actual.b - guess.b, 2)
      );
      const maxDiff = Math.sqrt(3 * Math.pow(255, 2));
      const accuracy = 100 - (diff / maxDiff) * 100;
      return accuracy.toFixed(2);
    }

    document.getElementById("startBtn").onclick = () => {
      const inputSeed = document.getElementById("seedInput").value.trim();
      seed = inputSeed || Math.random().toString(36).substring(2, 10);
      document.getElementById("seedDisplay").textContent = seed;
      targetColor = seededColor(seed);

      const refBox = document.getElementById("referenceColor");
      showElement(refBox);
      showColor(refBox, targetColor);

      // Hide after 5 seconds
      setTimeout(() => {
        hideElement(refBox);
      }, 5000);

      // Reset guess box
      document.getElementById("guessColor").style.backgroundColor = "#000";
      document.getElementById("results").innerHTML = "";
    };

    document.getElementById("submitGuess").onclick = () => {
      const hex = document.getElementById("colorGuess").value;
      const guess = hexToRGB(hex);

      const guessBox = document.getElementById("guessColor");
      guessBox.style.backgroundColor = hex;

      const accuracy = calculateAccuracy(targetColor, guess);

      document.getElementById("results").innerHTML = `
        <h3>Result</h3>
        <div class="row">
          <div>
            <p><strong>Actual Color:</strong></p>
            <div class="color-box" style="background-color: rgb(${targetColor.r}, ${targetColor.g}, ${targetColor.b});"></div>
            <p>rgb(${targetColor.r}, ${targetColor.g}, ${targetColor.b})</p>
          </div>
          <div>
            <p><strong>Your Guess:</strong></p>
            <div class="color-box" style="background-color: ${hex};"></div>
            <p>rgb(${guess.r}, ${guess.g}, ${guess.b})</p>
          </div>
        </div>
        <p><strong>Accuracy:</strong> ${accuracy}%</p>
        <p><strong>Seed:</strong> ${seed}</p>
      `;
    };
  </script>
</body>
</html>
